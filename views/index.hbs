<div>
    <h1>Game List</h1>
    <table>
      <thead>
        <tr>
          <th>AppID</th>
          <th>Name</th>
          <th>Releasedate</th>
          <th>Requiredage</th>
          <th>Price</th>
          <th>DLCcount</th>
          <th>Windows</th>
          <th>Mac</th>
          <th>Linux</th>
          <th>Achievements</th>
          <th>Developers</th>
          <th>Publishers</th>
          <th>Categories</th>
          <th>Genres</th>
          <th>Positive</th>
          <th>Negative</th>
        </tr>
      </thead>
      <tbody>
        {{#if games}}
          {{#each games}}
            <tr>
            <form id="update-form-{{AppID}}" action="/gamelists/{{AppID}}" method="POST">
            <td>{{AppID}}</td>
            <td><input type="text" name="Name" value="{{Name}}" required /></td>
            <td><input type="date" name="Releasedate" value="{{Releasedate}}" required /></td>
            <td><input type="number" name="Requiredage" value="{{Requiredage}}" min="0" /></td>
            <td><input type="number" name="Price" value="{{Price}}" min="0" step="0.01" required /></td>
            <td><input type="number" name="DLCcount" value="{{DLCcount}}" min="0" /></td>
            <td><input type="checkbox" name="Windows" value="{{Windows}}" {{#if (isTrue Windows)}}checked{{else}}{{/if}} /></td>
            <td><input type="checkbox" name="Mac" value="{{Mac}}" {{#if (isTrue Mac)}}checked{{else}}{{/if}} /></td>
            <td><input type="checkbox" name="Linux" value="{{Linux}}" {{#if (isTrue Linux)}}checked{{else}}{{/if}} /></td>
            <td><input type="number" name="Achievements" value="{{Achievements}}" min="0" /></td>
            <td><input type="text" name="Developers" value="{{Developers}}" required /></td>
            <td><input type="text" name="Publishers" value="{{Publishers}}" required /></td>
            <td><input type="text" name="Categories" value="{{Categories}}" required /></td>
            <td><input type="text" name="Genres" value="{{Genres}}" required /></td>
            <td><input type="number" name="Positive" value="{{Positive}}" min="0" /></td>
            <td><input type="number" name="Negative" value="{{Negative}}" min="0" /></td>
            <td>
              <button type="submit">Update</button> 
            </form>
            <form action="/delete/{{AppID}}" method="POST" style="display:inline;">
                <button type="submit">Delete</button>
              </form>
            </td>
          </tr>
        {{else}}
        {{/each}}
        {{/if}}
      </tbody>
    </table>

    <h2>Add New Game</h2>
      <form action="/games" method="POST">
        <label for="AppID">AppID</label>
        <input type="number" id="AppID" name="AppID" required>
        </br>
        
        <label for="Name">Name</label>
        <input type="text" id="Name" name="Name" required>
        </br>

        <label for="Releasedate">Release Date</label>
        <input type="date" id="Releasedate" name="Releasedate" required>
        </br>

        <label for="Requiredage">Required Age</label>
        <input type="number" id="Requiredage" name="Requiredage" min="0" required>
        </br>

        <label for="Price">Price</label>
        <input type="number" id="Price" name="Price" min="0" required>
        </br>

        <label for="DLCcount">DLCcount</label>
        <input type="number" id="DLCcount" name="DLCcount" min="0" required>
        </br>

        <label for="Windows">Windows</label>
        <input type="checkbox" id="Windows" name="Windows">
        </br>

        <label for="Mac">Mac</label>
        <input type="checkbox" id="Mac" name="Mac"></textarea>
        </br>

        <label for="Linux">Linux</label>
        <input type="checkbox" id="Linux" name="Linux">
        </br>
        
        <label for="Achievements">Achievements</label>
        <input type="text" id="Achievements" name="Achievements" required>
        </br>

        <label for="Developers">Developers</label>
        <input type="text" id="Developers" name="Developers" required>
        </br>

        <label for="Publishers">Publishers</label>
        <input type="text" id="Publishers" name="Publishers" required>
        </br>

        <label for="Categories">Categories</label>
        <input type="text" id="Categories" name="Categories" required>
        </br>

        <label for="Genres">Genres</label>
        <input type="text" id="Genres" name="Genres" required>
        </br>

        <label for="Positive">Positive</label>
        <input type="number" id="Positive" name="Positive" min="0" required>
        </br>

        <label for="Negative">Negative</label>
        <input type="number" id="Negative" name="Negative" min="0" required>
        </br>

        <button type="submit">Add Game</button>
      </form>

      <h2>Search record</h2>
      <form action="/search" method="POST">
        <label for="AppID">AppID</label>
        <input type="number" id="AppID" name="AppID" required>
        </br>
        <button type="submit">Update details</button>
      </form>
        <form action="/" method="GET">
          <button type="submit">Refresh</button>
        </form>

      {{#if needRecovery}}
        <h2>Nodes are out of sync please sync nodes</h2>
       <form action="/sync" method="GET">
          <button type="submit">SYNC</button>
        </form>
      {{else}}
      {{/if}}
      <!-- import csv buttons
      <button id="import-csv-for-central-node">Import CSV for Central Node</button>
      <button id="import-csv-for-node-2">Import CSV for Node 2</button>
      <button id="import-csv-for-node-3">Import CSV for Node 3</button>
      <div id="loading-csv"></div>-->
</div>

<script>

  //importing csv
  /*const importCsvBtn = document.querySelector('#import-csv-for-central-node');
  importCsvBtn.addEventListener('click', async () => {
    try{
      const loading = document.querySelector('#loading-csv');
      loading.innerHTML = 'Importing CSV... Wait for page to refresh.'
      const response = await fetch('/importcsv', {
        method: 'GET'
      });
      if(response.ok) {
        location.reload();
      } else {
        alert('CSV ALREADY IMPORTED');
        location.reload();
      }
    } catch(e) {
      console.log(err);
    }
  });

  const importCsvBtn2 = document.querySelector('#import-csv-for-node-2');
  importCsvBtn2.addEventListener('click', async () => {
    try{
      const loading = document.querySelector('#loading-csv');
      loading.innerHTML = 'Importing CSV... Wait for page to refresh.'
      const response = await fetch('/importcsvnode2', {
        method: 'GET'
      });
      if(response.ok) {
        location.reload();
      } else {
        alert('CSV ALREADY IMPORTED');
        location.reload();
      }
    } catch(e) {
      console.log(err);
    }
  });

   const importCsvBtn3 = document.querySelector('#import-csv-for-node-3');
  importCsvBtn3.addEventListener('click', async () => {
    try{
      const loading = document.querySelector('#loading-csv');
      loading.innerHTML = 'Importing CSV... Wait for page to refresh.'
      const response = await fetch('/importcsvnode3', {
        method: 'GET'
      });
      if(response.ok) {
        location.reload();
      } else {
        alert('CSV ALREADY IMPORTED');
        location.reload();
      }
    } catch(e) {
      console.log(err);
    }
  });*/
</script>